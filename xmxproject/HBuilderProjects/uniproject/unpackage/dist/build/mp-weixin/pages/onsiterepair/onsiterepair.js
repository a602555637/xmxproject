(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/onsiterepair/onsiterepair"],{"0399":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c},o=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return o})},"14a2":function(e,t,i){"use strict";(function(e){i("cc51"),i("921b");n(i("66fd"));var t=n(i("e8c1"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("543d")["createPage"])},"247b":function(e,t,i){"use strict";var n=i("db75"),o=i.n(n);o.a},d7e0:function(e,t,i){"use strict";i.r(t);var n=i("ed80"),o=i.n(n);for(var r in n)"default"!==r&&function(e){i.d(t,e,function(){return n[e]})}(r);t["default"]=o.a},db75:function(e,t,i){},e8c1:function(e,t,i){"use strict";i.r(t);var n=i("0399"),o=i("d7e0");for(var r in o)"default"!==r&&function(e){i.d(t,e,function(){return o[e]})}(r);i("247b");var s=i("2877"),c=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,null,null);t["default"]=c.exports},ed80:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(i("3e23"));function n(e){return e&&e.__esModule?e:{default:e}}var o=function(){return Promise.all([i.e("common/vendor"),i.e("wxcomponents/xlocation/xlocation")]).then(i.bind(null,"7d47"))},r=function(){return i.e("components/uni-list-c/uni-list").then(i.bind(null,"43f3"))},s=function(){return i.e("components/uni-list-item-c/uni-list-item").then(i.bind(null,"02d3"))},c=function(){return Promise.all([i.e("common/vendor"),i.e("components/rattenking-dtpicker/rattenking-dtpicker")]).then(i.bind(null,"4d58"))},a=function(){return i.e("wxcomponents/xlist/xlist").then(i.bind(null,"1135"))},u=function(){return i.e("wxcomponents/xlist/xlist-input").then(i.bind(null,"a083"))},d=function(){return i.e("wxcomponents/xlist/xlistPrice").then(i.bind(null,"262e"))},l=function(){return i.e("components/uni-number-box/uni-number-box").then(i.bind(null,"94e7"))},f=function(){return i.e("wxcomponents/getcode/getcode").then(i.bind(null,"933b"))},h=(i("d02b"),{onShow:function(){e.getStorage({key:"openId",success:function(e){e.data}})},data:function(){return{isVip:"2",superiorId:"",scode:"",phoneCode:"",detail:"",openId:"",date:"",orderNum:"",orderName:"",sprice:[],brand:"",model:"",colorName:"",repairList:[],orderInfo:"orderInfo",province:"",city:"",district:"",township:"",isChange:!0,currentMinutes:10,currentHour:10,currentDate:12,dateItem:[["日期","01","02","03","04","05","06","07","09",10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],["小时","08","09",10,11,12,13,14,15,16,17,18,19,20],["分钟",10,20,30,40,50]],kiloValue:1,isConfirm:!1,kiloPrice:5,isAgreement:!0,totalPrice:0,costPrice:0,presentPrice:0}},components:{uniList:r,uniListItem:s,rattenkingDtpicker:c,xlist:a,xlistInput:u,uniNumberBox:l,getcode:f,xlocation:o,xlistPrice:d},methods:{requestVip:function(t){var i=this;e.request({url:"https://www.finetwm.com/xmRepair/userInfo/isvip",method:"GET",data:{openId:t,superiorId:this.superiorId},success:function(e){i.isVip=e.data.data},fail:function(e){console.log(e)}})},bindScode:function(e){this.scode=e.scode},bindPhoneCode:function(e){this.phoneCode=e.phoneCode},bindInputName:function(e){this.orderName=e},bindInputNumber:function(e){this.orderNum=e},onOrderDetail:function(){this.isAgreement&&e.navigateTo({url:"../orderdetail/orderdetail"})},onConfirm:function(){this.isConfirm=!this.isConfirm},onNext:function(){this.isConfirm&&e.navigateTo({url:"../bevip/bevip"})},onOrder:function(){this.orderName?this.orderNum?this.district?this.isConfirm?this.phoneCode!==this.scode?e.showToast({title:"验证码不正确",icon:"none"}):e.request({url:"https://www.finetwm.com/xmRepair/order/saveUserOrder",method:"POST",header:{"content-type":"application/json"},data:{detail:this.detail,distance:this.kiloValue,price:this.totalPrice,userId:this.openId,userName:this.orderName,userPhone:this.orderNum,userAddress:this.district,serviceMode:0,serviceTime:this.date,phone:{brand:this.brand,model:this.model,colour:this.colorName},faults:[{faults:this.repairList[0],price:this.sprice[0]},{faults:this.repairList[1],price:this.sprice[1]}]},success:function(t){console.log(t),e.reLaunch({url:"../orderdetail/orderdetail",success:function(e){console.log("success")}})},fail:function(e){console.log(e)}}):e.showToast({title:"请同意协议",icon:"none"}):e.showToast({title:"请输入详细地址",icon:"none"}):e.showToast({title:"请输入手机号码",icon:"none"}):e.showToast({title:"请输入姓名",icon:"none"})},onNumber:function(e){this.kiloValue=e,this.onPrice(e)},onPrice:function(t){var i=this;this.kiloPrice=5*t,e.getStorage({key:"totalPrice",success:function(e){i.totalPrice=e.data;var t=e.data;if(i.totalPrice=i.totalPrice+i.kiloPrice,i.costPrice=e.data+5,i.costPrice=i.costPrice+i.kiloPrice,"1"===i.isVip)i.presentPrice=.8*t+i.kiloPrice;else{if("2"!==i.isVip)return;i.presentPrice=.5*t+i.kiloPrice}}})},bindPickerChange:function(e){console.log(e.detail.value);var t=e.detail.value;if(0==t[0])return this.currentDate;var i=this.dateItem[0];if(this.currentDate=i[t[0]],0==t[1])return this.currentHour;var n=this.dateItem[1];if(this.currentHour=n[t[1]],0==t[2])return this.currentMinutes;var o=this.dateItem[2];this.currentMinutes=o[t[2]],this.dateFmt(this.date)},getDate:function(){var e=new Date,t=e.getDate(),i=e.getHours(),n=e.getMinutes();this.currentDate=t,this.currentHour=i,this.currentMinutes=n;var o=e.toLocaleString("chinese",{hour12:!1});this.dateFmt(o)},dateFmt:function(e){if(null!==e&&""!=e){var t=new Date(e),i=t.getFullYear(),n=t.getMonth()+1;n<10&&(n="0"+n);var o=t.getDate();o<10&&(o="0"+o);var r=i+"."+n+"."+o+" "+this.currentHour+":"+this.currentMinutes;this.date=r}else console.log("fail")},onDateItem:function(){var e=this.dateItem[0].splice(0,1)+","+this.dateItem[0].splice(this.currentDate-2,29);this.dateItem[0]=e.split(",")},onCancel:function(){this.getDate()},getStorage:function(){var t=this;e.getStorage({key:"totalPrice",success:function(e){console.log(e.data),t.totalPrice=e.data+5,t.costPrice=e.data}})},bindDistrict:function(e){this.district=e.district+e.township+e.detailAddress},bindText:function(e){this.detail=e.detail.value}},onLoad:function(){var t=this;e.getStorage({key:"totalPrice",success:function(e){if(t.totalPrice=e.data,t.kiloPrice=5,"1"===t.isVip)t.presentPrice=.8*e.data+t.kiloPrice;else{if("2"!==t.isVip)return;t.presentPrice=.5*e.data+t.kiloPrice}}}),e.getStorage({key:"brand",success:function(e){t.brand=e.data}}),e.getStorage({key:"model",success:function(e){t.model=e.data}}),e.getStorage({key:"colorName",success:function(e){t.colorName=e.data}}),e.getStorage({key:"faulesTitle",success:function(e){t.repairList=e.data}}),e.getStorage({key:"sprice",success:function(e){t.sprice=e.data}}),e.getStorage({key:"orderName",success:function(e){t.orderName=e.data}}),e.getStorage({key:"orderNum",success:function(e){t.orderNum=e.data}}),e.getStorage({key:"openId",success:function(e){t.openId=e.data}}),this.onNumber(),this.getDate(),this.onDateItem(),this.getStorage()}});t.default=h}).call(this,i("543d")["default"])}},[["14a2","common/runtime","common/vendor"]]]);